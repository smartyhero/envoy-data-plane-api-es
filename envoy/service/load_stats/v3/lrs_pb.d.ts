// @generated by protoc-gen-es v2.10.0
// @generated from file envoy/service/load_stats/v3/lrs.proto (package envoy.service.load_stats.v3, syntax proto3)
/* eslint-disable */

import type { GenFile, GenMessage, GenService } from "@bufbuild/protobuf/codegenv2";
import type { Message } from "@bufbuild/protobuf";
import type { Node } from "../../../config/core/v3/base_pb";
import type { ClusterStats } from "../../../config/endpoint/v3/load_report_pb";
import type { Duration } from "@bufbuild/protobuf/wkt";

/**
 * Describes the file envoy/service/load_stats/v3/lrs.proto.
 */
export declare const file_envoy_service_load_stats_v3_lrs: GenFile;

/**
 * A load report Envoy sends to the management server.
 *
 * @generated from message envoy.service.load_stats.v3.LoadStatsRequest
 */
export declare type LoadStatsRequest = Message<"envoy.service.load_stats.v3.LoadStatsRequest"> & {
  /**
   * Node identifier for Envoy instance.
   *
   * @generated from field: envoy.config.core.v3.Node node = 1;
   */
  node?: Node;

  /**
   * A list of load stats to report.
   *
   * @generated from field: repeated envoy.config.endpoint.v3.ClusterStats cluster_stats = 2;
   */
  clusterStats: ClusterStats[];
};

/**
 * Describes the message envoy.service.load_stats.v3.LoadStatsRequest.
 * Use `create(LoadStatsRequestSchema)` to create a new message.
 */
export declare const LoadStatsRequestSchema: GenMessage<LoadStatsRequest>;

/**
 * The management server sends envoy a LoadStatsResponse with all clusters it
 * is interested in learning load stats about.
 *
 * @generated from message envoy.service.load_stats.v3.LoadStatsResponse
 */
export declare type LoadStatsResponse = Message<"envoy.service.load_stats.v3.LoadStatsResponse"> & {
  /**
   * Clusters to report stats for.
   * Not populated if ``send_all_clusters`` is true.
   *
   * @generated from field: repeated string clusters = 1;
   */
  clusters: string[];

  /**
   * If true, the client should send all clusters it knows about.
   * Only clients that advertise the "envoy.lrs.supports_send_all_clusters" capability in their
   * :ref:`client_features<envoy_v3_api_field_config.core.v3.Node.client_features>` field will honor this field.
   *
   * @generated from field: bool send_all_clusters = 4;
   */
  sendAllClusters: boolean;

  /**
   * The minimum interval of time to collect stats over. This is only a minimum for two reasons:
   *
   * 1. There may be some delay from when the timer fires until stats sampling occurs.
   * 2. For clusters that were already feature in the previous ``LoadStatsResponse``, any traffic
   *    that is observed in between the corresponding previous ``LoadStatsRequest`` and this
   *    ``LoadStatsResponse`` will also be accumulated and billed to the cluster. This avoids a period
   *    of inobservability that might otherwise exists between the messages. New clusters are not
   *    subject to this consideration.
   *
   * @generated from field: google.protobuf.Duration load_reporting_interval = 2;
   */
  loadReportingInterval?: Duration;

  /**
   * Set to ``true`` if the management server supports endpoint granularity
   * report.
   *
   * @generated from field: bool report_endpoint_granularity = 3;
   */
  reportEndpointGranularity: boolean;
};

/**
 * Describes the message envoy.service.load_stats.v3.LoadStatsResponse.
 * Use `create(LoadStatsResponseSchema)` to create a new message.
 */
export declare const LoadStatsResponseSchema: GenMessage<LoadStatsResponse>;

/**
 * @generated from service envoy.service.load_stats.v3.LoadReportingService
 */
export declare const LoadReportingService: GenService<{
  /**
   * Advanced API to allow for multi-dimensional load balancing by remote
   * server. For receiving LB assignments, the steps are:
   * 1, The management server is configured with per cluster/zone/load metric
   *    capacity configuration. The capacity configuration definition is
   *    outside of the scope of this document.
   * 2. Envoy issues a standard {Stream,Fetch}Endpoints request for the clusters
   *    to balance.
   *
   * Independently, Envoy will initiate a StreamLoadStats bidi stream with a
   * management server:
   * 1. Once a connection establishes, the management server publishes a
   *    LoadStatsResponse for all clusters it is interested in learning load
   *    stats about.
   * 2. For each cluster, Envoy load balances incoming traffic to upstream hosts
   *    based on per-zone weights and/or per-instance weights (if specified)
   *    based on intra-zone LbPolicy. This information comes from the above
   *    {Stream,Fetch}Endpoints.
   * 3. When upstream hosts reply, they optionally add header <define header
   *    name> with ASCII representation of EndpointLoadMetricStats.
   * 4. Envoy aggregates load reports over the period of time given to it in
   *    LoadStatsResponse.load_reporting_interval. This includes aggregation
   *    stats Envoy maintains by itself (total_requests, rpc_errors etc.) as
   *    well as load metrics from upstream hosts.
   * 5. When the timer of load_reporting_interval expires, Envoy sends new
   *    LoadStatsRequest filled with load reports for each cluster.
   * 6. The management server uses the load reports from all reported Envoys
   *    from around the world, computes global assignment and prepares traffic
   *    assignment destined for each zone Envoys are located in. Goto 2.
   *
   * @generated from rpc envoy.service.load_stats.v3.LoadReportingService.StreamLoadStats
   */
  streamLoadStats: {
    methodKind: "bidi_streaming";
    input: typeof LoadStatsRequestSchema;
    output: typeof LoadStatsResponseSchema;
  },
}>;

