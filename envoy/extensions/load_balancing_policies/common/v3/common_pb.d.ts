// @generated by protoc-gen-es v2.10.0
// @generated from file envoy/extensions/load_balancing_policies/common/v3/common.proto (package envoy.extensions.load_balancing_policies.common.v3, syntax proto3)
/* eslint-disable */

import type { GenEnum, GenFile, GenMessage } from "@bufbuild/protobuf/codegenv2";
import type { Message } from "@bufbuild/protobuf";
import type { Percent } from "../../../../type/v3/percent_pb";
import type { Duration } from "@bufbuild/protobuf/wkt";
import type { RuntimeDouble } from "../../../../config/core/v3/base_pb";
import type { RouteAction_HashPolicy } from "../../../../config/route/v3/route_components_pb";

/**
 * Describes the file envoy/extensions/load_balancing_policies/common/v3/common.proto.
 */
export declare const file_envoy_extensions_load_balancing_policies_common_v3_common: GenFile;

/**
 * @generated from message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig
 */
export declare type LocalityLbConfig = Message<"envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig"> & {
  /**
   * @generated from oneof envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.locality_config_specifier
   */
  localityConfigSpecifier: {
    /**
     * Configuration for local zone aware load balancing.
     *
     * @generated from field: envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig zone_aware_lb_config = 1;
     */
    value: LocalityLbConfig_ZoneAwareLbConfig;
    case: "zoneAwareLbConfig";
  } | {
    /**
     * Enable locality weighted load balancing.
     *
     * @generated from field: envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.LocalityWeightedLbConfig locality_weighted_lb_config = 2;
     */
    value: LocalityLbConfig_LocalityWeightedLbConfig;
    case: "localityWeightedLbConfig";
  } | { case: undefined; value?: undefined };
};

/**
 * Describes the message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.
 * Use `create(LocalityLbConfigSchema)` to create a new message.
 */
export declare const LocalityLbConfigSchema: GenMessage<LocalityLbConfig>;

/**
 * Configuration for :ref:`zone aware routing
 * <arch_overview_load_balancing_zone_aware_routing>`.
 * [#next-free-field: 7]
 *
 * @generated from message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig
 */
export declare type LocalityLbConfig_ZoneAwareLbConfig = Message<"envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig"> & {
  /**
   * Configures percentage of requests that will be considered for zone aware routing
   * if zone aware routing is configured. If not specified, the default is 100%.
   * * :ref:`runtime values <config_cluster_manager_cluster_runtime_zone_routing>`.
   * * :ref:`Zone aware routing support <arch_overview_load_balancing_zone_aware_routing>`.
   *
   * @generated from field: envoy.type.v3.Percent routing_enabled = 1;
   */
  routingEnabled?: Percent;

  /**
   * Configures minimum upstream cluster size required for zone aware routing
   * If upstream cluster size is less than specified, zone aware routing is not performed
   * even if zone aware routing is configured. If not specified, the default is 6.
   * * :ref:`runtime values <config_cluster_manager_cluster_runtime_zone_routing>`.
   * * :ref:`Zone aware routing support <arch_overview_load_balancing_zone_aware_routing>`.
   *
   * @generated from field: google.protobuf.UInt64Value min_cluster_size = 2;
   */
  minClusterSize?: bigint;

  /**
   * If set to true, Envoy will not consider any hosts when the cluster is in :ref:`panic
   * mode<arch_overview_load_balancing_panic_threshold>`. Instead, the cluster will fail all
   * requests as if all hosts are unhealthy. This can help avoid potentially overwhelming a
   * failing service.
   *
   * @generated from field: bool fail_traffic_on_panic = 3;
   */
  failTrafficOnPanic: boolean;

  /**
   * If set to true, Envoy will force LocalityDirect routing if a local locality exists.
   *
   * @generated from field: bool force_locality_direct_routing = 4 [deprecated = true];
   * @deprecated
   */
  forceLocalityDirectRouting: boolean;

  /**
   * @generated from field: envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.ForceLocalZone force_local_zone = 5;
   */
  forceLocalZone?: LocalityLbConfig_ZoneAwareLbConfig_ForceLocalZone;

  /**
   * Determines how locality percentages are computed:
   * - HEALTHY_HOSTS_NUM: proportional to the count of healthy hosts.
   * - HEALTHY_HOSTS_WEIGHT: proportional to the weights of healthy hosts.
   * Default value is HEALTHY_HOSTS_NUM if unset.
   *
   * @generated from field: envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.LocalityBasis locality_basis = 6;
   */
  localityBasis: LocalityLbConfig_ZoneAwareLbConfig_LocalityBasis;
};

/**
 * Describes the message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.
 * Use `create(LocalityLbConfig_ZoneAwareLbConfigSchema)` to create a new message.
 */
export declare const LocalityLbConfig_ZoneAwareLbConfigSchema: GenMessage<LocalityLbConfig_ZoneAwareLbConfig>;

/**
 * Configures Envoy to always route requests to the local zone regardless of the
 * upstream zone structure. In Envoy's default configuration, traffic is distributed proportionally
 * across all upstream hosts while trying to maximize local routing when possible. The approach
 * with force_local_zone aims to be more predictable and if there are upstream hosts in the local
 * zone, they will receive all traffic.
 * * :ref:`runtime values <config_cluster_manager_cluster_runtime_zone_routing>`.
 * * :ref:`Zone aware routing support <arch_overview_load_balancing_zone_aware_routing>`.
 *
 * @generated from message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.ForceLocalZone
 */
export declare type LocalityLbConfig_ZoneAwareLbConfig_ForceLocalZone = Message<"envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.ForceLocalZone"> & {
  /**
   * Configures the minimum number of upstream hosts in the local zone required when force_local_zone
   * is enabled. If the number of upstream hosts in the local zone is less than the specified value,
   * Envoy will fall back to the default proportional-based distribution across localities.
   * If not specified, the default is 1.
   * * :ref:`runtime values <config_cluster_manager_cluster_runtime_zone_routing>`.
   * * :ref:`Zone aware routing support <arch_overview_load_balancing_zone_aware_routing>`.
   *
   * @generated from field: google.protobuf.UInt32Value min_size = 1;
   */
  minSize?: number;
};

/**
 * Describes the message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.ForceLocalZone.
 * Use `create(LocalityLbConfig_ZoneAwareLbConfig_ForceLocalZoneSchema)` to create a new message.
 */
export declare const LocalityLbConfig_ZoneAwareLbConfig_ForceLocalZoneSchema: GenMessage<LocalityLbConfig_ZoneAwareLbConfig_ForceLocalZone>;

/**
 * Basis for computing per-locality percentages in zone-aware routing.
 *
 * @generated from enum envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.LocalityBasis
 */
export enum LocalityLbConfig_ZoneAwareLbConfig_LocalityBasis {
  /**
   * Use the number of healthy hosts in each locality.
   *
   * @generated from enum value: HEALTHY_HOSTS_NUM = 0;
   */
  HEALTHY_HOSTS_NUM = 0,

  /**
   * Use the weights of healthy hosts in each locality.
   *
   * @generated from enum value: HEALTHY_HOSTS_WEIGHT = 1;
   */
  HEALTHY_HOSTS_WEIGHT = 1,
}

/**
 * Describes the enum envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.ZoneAwareLbConfig.LocalityBasis.
 */
export declare const LocalityLbConfig_ZoneAwareLbConfig_LocalityBasisSchema: GenEnum<LocalityLbConfig_ZoneAwareLbConfig_LocalityBasis>;

/**
 * Configuration for :ref:`locality weighted load balancing
 * <arch_overview_load_balancing_locality_weighted_lb>`
 *
 * @generated from message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.LocalityWeightedLbConfig
 */
export declare type LocalityLbConfig_LocalityWeightedLbConfig = Message<"envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.LocalityWeightedLbConfig"> & {
};

/**
 * Describes the message envoy.extensions.load_balancing_policies.common.v3.LocalityLbConfig.LocalityWeightedLbConfig.
 * Use `create(LocalityLbConfig_LocalityWeightedLbConfigSchema)` to create a new message.
 */
export declare const LocalityLbConfig_LocalityWeightedLbConfigSchema: GenMessage<LocalityLbConfig_LocalityWeightedLbConfig>;

/**
 * Configuration for :ref:`slow start mode <arch_overview_load_balancing_slow_start>`.
 *
 * @generated from message envoy.extensions.load_balancing_policies.common.v3.SlowStartConfig
 */
export declare type SlowStartConfig = Message<"envoy.extensions.load_balancing_policies.common.v3.SlowStartConfig"> & {
  /**
   * Represents the size of slow start window.
   * If set, the newly created host remains in slow start mode starting from its creation time
   * for the duration of slow start window.
   *
   * @generated from field: google.protobuf.Duration slow_start_window = 1;
   */
  slowStartWindow?: Duration;

  /**
   * This parameter controls the speed of traffic increase over the slow start window. Defaults to 1.0,
   * so that endpoint would get linearly increasing amount of traffic.
   * When increasing the value for this parameter, the speed of traffic ramp-up increases non-linearly.
   * The value of aggression parameter should be greater than 0.0.
   * By tuning the parameter, is possible to achieve polynomial or exponential shape of ramp-up curve.
   *
   * During slow start window, effective weight of an endpoint would be scaled with time factor and aggression:
   * ``new_weight = weight * max(min_weight_percent, time_factor ^ (1 / aggression))``,
   * where ``time_factor=(time_since_start_seconds / slow_start_time_seconds)``.
   *
   * As time progresses, more and more traffic would be sent to endpoint, which is in slow start window.
   * Once host exits slow start, time_factor and aggression no longer affect its weight.
   *
   * @generated from field: envoy.config.core.v3.RuntimeDouble aggression = 2;
   */
  aggression?: RuntimeDouble;

  /**
   * Configures the minimum percentage of origin weight that avoids too small new weight,
   * which may cause endpoints in slow start mode receive no traffic in slow start window.
   * If not specified, the default is 10%.
   *
   * @generated from field: envoy.type.v3.Percent min_weight_percent = 3;
   */
  minWeightPercent?: Percent;
};

/**
 * Describes the message envoy.extensions.load_balancing_policies.common.v3.SlowStartConfig.
 * Use `create(SlowStartConfigSchema)` to create a new message.
 */
export declare const SlowStartConfigSchema: GenMessage<SlowStartConfig>;

/**
 * Common Configuration for all consistent hashing load balancers (MaglevLb, RingHashLb, etc.)
 *
 * @generated from message envoy.extensions.load_balancing_policies.common.v3.ConsistentHashingLbConfig
 */
export declare type ConsistentHashingLbConfig = Message<"envoy.extensions.load_balancing_policies.common.v3.ConsistentHashingLbConfig"> & {
  /**
   * If set to ``true``, the cluster will use hostname instead of the resolved
   * address as the key to consistently hash to an upstream host. Only valid for StrictDNS clusters with hostnames which resolve to a single IP address.
   *
   * @generated from field: bool use_hostname_for_hashing = 1;
   */
  useHostnameForHashing: boolean;

  /**
   * Configures percentage of average cluster load to bound per upstream host. For example, with a value of 150
   * no upstream host will get a load more than 1.5 times the average load of all the hosts in the cluster.
   * If not specified, the load is not bounded for any upstream host. Typical value for this parameter is between 120 and 200.
   * Minimum is 100.
   *
   * Applies to both Ring Hash and Maglev load balancers.
   *
   * This is implemented based on the method described in the paper https://arxiv.org/abs/1608.01350. For the specified
   * ``hash_balance_factor``, requests to any upstream host are capped at ``hash_balance_factor/100`` times the average number of requests
   * across the cluster. When a request arrives for an upstream host that is currently serving at its max capacity, linear probing
   * is used to identify an eligible host. Further, the linear probe is implemented using a random jump in hosts ring/table to identify
   * the eligible host (this technique is as described in the paper https://arxiv.org/abs/1908.08762 - the random jump avoids the
   * cascading overflow effect when choosing the next host in the ring/table).
   *
   * If weights are specified on the hosts, they are respected.
   *
   * This is an O(N) algorithm, unlike other load balancers. Using a lower ``hash_balance_factor`` results in more hosts
   * being probed, so use a higher value if you require better performance.
   *
   * @generated from field: google.protobuf.UInt32Value hash_balance_factor = 2;
   */
  hashBalanceFactor?: number;

  /**
   *  Specifies a list of hash policies to use for ring hash load balancing. If ``hash_policy`` is
   * set, then
   * :ref:`route level hash policy <envoy_v3_api_field_config.route.v3.RouteAction.hash_policy>`
   * will be ignored.
   *
   * @generated from field: repeated envoy.config.route.v3.RouteAction.HashPolicy hash_policy = 3;
   */
  hashPolicy: RouteAction_HashPolicy[];
};

/**
 * Describes the message envoy.extensions.load_balancing_policies.common.v3.ConsistentHashingLbConfig.
 * Use `create(ConsistentHashingLbConfigSchema)` to create a new message.
 */
export declare const ConsistentHashingLbConfigSchema: GenMessage<ConsistentHashingLbConfig>;

